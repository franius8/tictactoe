(()=>{const e=(e,t)=>({name:e,marker:t,selectField:e=>{const n=e.getAttribute("index");if(null===d.getBoard()[n])return d.addMarker(n,t),(e=>{const n=document.createElement("div");n.classList.add(t),e.appendChild(n)})(e),!0;a.displayTakenMessage()}}),t=(()=>{let t=0,i=null,r=null,l=1,s=null;const o=e=>{if(!0===i.selectField(e)){if(!0===d.isWon())return void u(!1);if(9===l)return void u(!0);l+=1,c()}},c=()=>{t=Math.abs(t-1),i=r[t],a.displayCurrentPlayer(i),i===n&&setTimeout((()=>{n.selectField(s),!0===d.isWon()&&u(!1),l+=1,c()}),1e3)},u=e=>{e?a.displayTieMessage():a.displayWinner(i.name),document.querySelectorAll(".field").forEach((e=>{const t=e.cloneNode(!0);e.parentNode.replaceChild(t,e)})),a.displayResetButton()};return{initializeGame:(t,n)=>{r=[e(t,"x"),e(n,"o")],a.displayBoard(d.getBoard()),a.addDisplayDivs(),i=r[0],a.displayCurrentPlayer(i),document.querySelectorAll(".field").forEach((e=>{e.addEventListener("click",(()=>{o(e)}))}))},initializePvCGame:(t,l)=>{r=[e(t,"x"),n],s=l,a.displayBoard(d.getBoard()),a.addDisplayDivs(),i=r[0],a.displayCurrentPlayer(i),document.querySelectorAll(".field").forEach((e=>{e.addEventListener("click",(()=>{o(e)}))}))},getCurrentPlayerMarker:()=>i.marker,resetGame:()=>{t=0,i=null,r=null,l=1,d.resetBoard(),a.hideBoard(),a.displayInitialButtons()}}})(),n=(()=>{let e=null,t=null;const n=()=>{let e=!1;for(;!1===e;){const t=Math.floor(9.99*Math.random());0!==t&&null===d.getBoard()[t]&&(r(t),e=!0)}},a=()=>{let t=null;return d.winningCombinations.forEach((e=>{let n=0,a=0,i=null;e.forEach((e=>{switch(d.getBoard()[e]){case"o":n+=1;break;case null:a+=1,i=e}})),2===n&&1===a&&(t=i)})),null!==t&&(e=t,!0)},i=()=>{let e=null;return d.winningCombinations.forEach((t=>{let n=0,a=0,i=null;t.forEach((e=>{switch(d.getBoard()[e]){case"x":n+=1;break;case null:a+=1,i=e}})),2===n&&1===a&&(e=i)})),null!==e&&(t=e,!0)},r=e=>{const t=document.querySelector(`[index="${e}"]`);d.addMarker(e,"o");const n=document.createElement("div");n.classList.add("o"),t.appendChild(n)};return{name:"computer",marker:"o",selectField:l=>{switch(l){case"easy":n();break;case"standard":a()?r(e):i()?r(t):null===d.getBoard()[5]?r(5):n()}}}})(),d=(()=>{let e=new Array(10).fill(null);const n=[[1,2,3],[4,5,6],[7,8,9],[1,4,7],[2,5,8],[3,6,9],[1,5,9],[3,5,7]],d=e=>e.every(a),a=n=>e[n]===t.getCurrentPlayerMarker();return{winningCombinations:n,getBoard:()=>e,addMarker:(t,n)=>e[t]=n,isWon:()=>n.some(d),isPresent:d,resetBoard:()=>{e=new Array(10).fill(null)}}})(),a=(()=>{const e=document.getElementById("display"),n=document.getElementById("board"),d=document.getElementById("content"),a=()=>{l();const t=document.createElement("button"),n=document.createElement("div"),d=document.createElement("button");t.textContent="Player vs Computer",n.textContent="or",d.textContent="Player vs Player",e.appendChild(t),e.appendChild(n),e.appendChild(d),t.addEventListener("click",(()=>{i()})),d.addEventListener("click",(()=>{r()}))},i=()=>{l();const n=document.createElement("button");n.textContent="← Return";const d=document.createElement("form");d.setAttribute("id","form");const i=document.createElement("label");i.setAttribute("for","player1name"),i.textContent="First player's name:";const r=document.createElement("input");r.setAttribute("id","player1name"),r.setAttribute("type","text"),r.setAttribute("required","true");const s=document.createElement("label");s.setAttribute("for","radiocontainer"),s.textContent="Select difficulty:";const o=document.createElement("div");o.setAttribute("id","radiocontainer");const c=document.createElement("label");c.setAttribute("for","difficultyleveleasy"),c.textContent="Easy";const u=document.createElement("input");u.setAttribute("id","difficultyleveleasy"),u.setAttribute("type","radio"),u.setAttribute("value","easy"),u.setAttribute("required","true"),u.setAttribute("name","difficulty");const m=document.createElement("label");m.setAttribute("for","difficultylevelstandard"),m.textContent="Standard";const p=document.createElement("input");p.setAttribute("id","difficultylevelstandard"),p.setAttribute("type","radio"),p.setAttribute("value","standard"),p.setAttribute("required","true"),p.setAttribute("name","difficulty");const y=document.createElement("button");y.setAttribute("type","submit"),y.textContent="New game",o.appendChild(u),o.appendChild(c),o.appendChild(p),o.appendChild(m),d.appendChild(n),d.appendChild(i),d.appendChild(r),d.appendChild(s),d.appendChild(o),d.appendChild(y),e.appendChild(d),n.addEventListener("click",(()=>{a()})),d.addEventListener("submit",(e=>{e.preventDefault();const n=document.getElementById("player1name").value,a=document.querySelector('input[name="difficulty"]:checked').value;e.target.reset(),d.remove(),t.initializePvCGame(n,a)}))},r=()=>{l();const n=document.createElement("button");n.textContent="← Return";const d=document.createElement("form");d.setAttribute("id","form");const i=document.createElement("label");i.setAttribute("for","player1name"),i.textContent="First player's name:";const r=document.createElement("input");r.setAttribute("id","player1name"),r.setAttribute("type","text"),r.setAttribute("required","true");const s=document.createElement("label");s.setAttribute("for","player2name"),s.textContent="Second player's name:";const o=document.createElement("input");o.setAttribute("id","player2name"),o.setAttribute("type","text"),o.setAttribute("required","true");const c=document.createElement("button");c.setAttribute("type","submit"),c.textContent="New game",d.appendChild(n),d.appendChild(i),d.appendChild(r),d.appendChild(s),d.appendChild(o),d.appendChild(c),e.appendChild(d),n.addEventListener("click",(()=>{a()})),d.addEventListener("submit",(e=>{e.preventDefault();const n=document.getElementById("player1name").value,a=document.getElementById("player2name").value;e.target.reset(),d.remove(),t.initializeGame(n,a)}))},l=()=>{e.textContent=""},s=()=>{const n=document.createElement("button");n.setAttribute("id","resetbutton"),n.textContent="New game",e.appendChild(n),n.addEventListener("click",(()=>{t.resetGame()}))};return{displayBoard:e=>{d.style.display="grid",e.forEach(((e,t)=>{const d=document.createElement("div");if(d.classList.add("field"),d.setAttribute("index",t),0!==t){if("x"===e){const e=document.createElement("div");e.classList.add("x"),d.appendChild(e)}else if("o"===e){const e=document.createElement("div");e.classList.add("o"),d.appendChild(e)}n.appendChild(d)}})),n.style.display="grid"},displayCurrentPlayer:e=>{document.getElementById("currentplayerdiv").textContent=e.name,(e=>{const t=document.getElementById("markerdiv"),n=document.createElement("div");t.innerHTML="",n.classList.add(e.marker),t.appendChild(n)})(e),(()=>{const e=document.getElementById("errordiv");e.textContent="",e.style.visibility="collapse"})()},displayTakenMessage:()=>{const e=document.getElementById("errordiv");e.textContent="Space already taken",e.style.visibility="visible"},addDisplayDivs:()=>{const t=document.createElement("div");t.setAttribute("id","errordiv");const n=document.createElement("div");n.setAttribute("id","currentplayerdiv");const d=document.createElement("div");d.setAttribute("id","currentplayerlabel"),d.textContent="Current player:";const a=document.createElement("div");a.setAttribute("id","markerdiv"),e.appendChild(t),e.appendChild(d),e.appendChild(n),e.appendChild(a),s()},displayWinner:t=>{l();const n=document.createElement("div");n.textContent=`${t} won!`,n.classList.add("winnerdiv"),e.appendChild(n)},displayResetButton:s,hideBoard:()=>{d.style.display="flex",n.textContent="",n.style.display="none"},displayTieMessage:()=>{l();const t=document.createElement("div");t.textContent="Tie",t.classList.add("winnerdiv"),e.appendChild(t)},displayInitialButtons:a}})();a.displayInitialButtons()})();